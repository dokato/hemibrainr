<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Determine a neuron's dendrite and axon by calculating flow centrality — flow_centrality • hemibrainr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Determine a neuron's dendrite and axon by calculating flow centrality — flow_centrality" />
<meta property="og:description" content="implementation of the algorithm for calculating flow
  centralities from Schneider-Mizell et al. (2016).
  Can be used on nat::neuronlist
  objects read using neuprint_read_neurons. The example code
  below gives the recommended arguments when using hemibrain data." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/flyconnectome/hemibrainr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Determine a neuron's dendrite and axon by calculating flow centrality</h1>
    <small class="dont-index">Source: <a href='https://github.com/flyconnectome/hemibrainr/blob/master/R/hemibrain_split.R'><code>R/hemibrain_split.R</code></a></small>
    <div class="hidden name"><code>flow_centrality.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>implementation of the algorithm for calculating flow
  centralities from Schneider-Mizell et al. (2016).
  Can be used on <code><a href='https://rdrr.io/pkg/nat/man/neuronlist.html'>nat::neuronlist</a></code>
  objects read using <code>neuprint_read_neurons</code>. The example code
  below gives the recommended arguments when using hemibrain data.</p>
    </div>

    <pre class="usage"><span class='fu'>flow_centrality</span>(
  <span class='no'>x</span>,
  <span class='kw'>mode</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sum"</span>, <span class='st'>"centrifugal"</span>, <span class='st'>"centripetal"</span>),
  <span class='kw'>polypre</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>soma</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>primary.dendrite</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>bending.flow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>split</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"distance"</span>, <span class='st'>"postsynapses"</span>, <span class='st'>"presynapses"</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='https://rdrr.io/pkg/nat/man/neuronlist.html'>nat::neuronlist</a></code> or <code><a href='https://rdrr.io/pkg/nat/man/neuron.html'>nat::neuron</a></code> object. It is assumed
that this neuron has been read in by <code><a href='https://rdrr.io/pkg/neuprintr/man/neuprint_read_neurons.html'>neuprintr::neuprint_read_neurons</a></code> or
possibly <code>catmaid::read.neurons.catmaid</code>.</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>type of flow centrality to calculate. There are three flavours:
(1) centrifugal, which counts paths from proximal inputs to distal outputs;
(2) centripetal, which counts paths from distal inputs to proximal outputs;
and (3) the sum of both.</p></td>
    </tr>
    <tr>
      <th>polypre</th>
      <td><p>whether to consider the number of presynapses as a multiple of
the numbers of connections each makes</p></td>
    </tr>
    <tr>
      <th>soma</th>
      <td><p>logical, whether or not the given neuron has a soma.
The soma should be its root. If it does, <code><a href='primary_neurite.html'>primary_neurite</a></code>
will be called to make sure the primary neurite is labelled correctly.</p></td>
    </tr>
    <tr>
      <th>primary.dendrite</th>
      <td><p>whether to try to assign nodes to a 'primary
dendrite'. Defaults to considering nodes of 0.9*maximal flow centrality.
Assigning to NULL will prevent generating this compartment.</p></td>
    </tr>
    <tr>
      <th>bending.flow</th>
      <td><p>we may need to add the 'bending flow' to all
the branchpoints if looking at centripetal flow centrality.</p></td>
    </tr>
    <tr>
      <th>split</th>
      <td><p>the algorithm will assign two main neurite compartments,
which as per SWC format will be indicates as either axon (Label =2)
or dendrite (Label = 3) in the returned objects, at neuron$d$Label.
This assignment can be based which compartment contains the most
postsynapses ("postsynapses") or presynapses ("presynapses"),
or the geodesic distance of its first branch point from the primary branch
point (i.e. the first branch point from the soma) ("distance").
The compartment closest to this branchpoint is most usually the dendrite
(Bates &amp; Schlegel 2020).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>methods sent to <code><a href='https://rdrr.io/pkg/nat/man/nlapply.html'>nat::nlapply</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>the neuron or neuron list object inputted, with centripetal flow
  centrality information added to neuron$d and a segregation index score.
  The neuron$d$Label now gives the compartment, where axon is Label = 2,
  dendrite Label = 3, primary dendrite Label = 9 and
  primary neurite Label = 7.
  Soma is Label = 1.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>From Schneider-Mizell et al. (2016): "We use flow centrality for
  four purposes. First, to split an arbor into axon and dendrite at the
  maximum centrifugal SFC, which is a preliminary step for computing the
  segregation index, for expressing all kinds of connectivity edges (e.g.
  axo-axonic, dendro-dendritic) in the wiring diagram, or for rendering the
  arbor in 3d with differently colored regions. Second, to quantitatively
  estimate the cable distance between the axon terminals and dendritic arbor
  by measuring the amount of cable with the maximum centrifugal SFC value.
  Third, to measure the cable length of the main dendritic shafts using
  centripetal SFC, which applies only to insect neurons with at least one
  output syn- apse in their dendritic arbor. And fourth, to weigh the color
  of each skeleton node in a 3d view, providing a characteristic signature of
  the arbor that enables subjective evaluation of its identity."</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Schneider-Mizell, C. M., Gerhard, S., Longair, M., Kazimiers, T.,
  Li, F., Zwart, M. F., … Cardona, A. (2015). Quantitative neuroanatomy for
  connectomics in Drosophila. bioRxiv, 026617. http://doi.org/10.1101/026617</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='primary_neurite.html'>primary_neurite</a></code>, <code><a href='hemibrain_skeleton_check.html'>hemibrain_skeleton_check</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'># Choose neurons</span>
<span class='co'>## These neurons are some 'tough' examples from the hemibrain:v1.0.1</span>
<span class='co'>### They will split differently depending on the parameters you use.</span>
<span class='no'>tough</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"5813056323"</span>, <span class='st'>"579912201"</span>, <span class='st'>"5813015982"</span>, <span class='st'>"973765182"</span>, <span class='st'>"885788485"</span>,
<span class='st'>"915451074"</span>, <span class='st'>"5813032740"</span>, <span class='st'>"1006854683"</span>, <span class='st'>"5813013913"</span>, <span class='st'>"5813020138"</span>,
<span class='st'>"853726809"</span>, <span class='st'>"916828438"</span>, <span class='st'>"5813078494"</span>, <span class='st'>"420956527"</span>, <span class='st'>"486116439"</span>,
<span class='st'>"573329873"</span>, <span class='st'>"5813010494"</span>, <span class='st'>"5813040095"</span>, <span class='st'>"514396940"</span>, <span class='st'>"665747387"</span>,
<span class='st'>"793702856"</span>, <span class='st'>"451644891"</span>, <span class='st'>"482002701"</span>, <span class='st'>"391631218"</span>, <span class='st'>"390948259"</span>,
<span class='st'>"390948580"</span>, <span class='st'>"452677169"</span>, <span class='st'>"511262901"</span>, <span class='st'>"422311625"</span>, <span class='st'>"451987038"</span>
)

<span class='co'># Get neurons</span>
<span class='no'>neurons</span> <span class='kw'>=</span> <span class='fu'>neuprint_read_neurons</span>(<span class='no'>tough</span>)

<span class='co'># Now make sure the neurons have a soma marked</span>
<span class='co'>## Some hemibrain neurons do not, as the soma was chopped off</span>
<span class='no'>neurons.checked</span> <span class='kw'>=</span> <span class='fu'><a href='hemibrain_skeleton_check.html'>hemibrain_skeleton_check</a></span>(<span class='no'>neurons</span>, <span class='kw'>meshes</span> <span class='kw'>=</span> <span class='no'>hemibrain.surf</span>)</div><div class='output co'>#&gt; <span class='message'>Re-rooting 3 neurons without a soma</span></div><div class='output co'>#&gt; <span class='message'>3 neurons re-rooted</span></div><div class='output co'>#&gt; <span class='message'>Removing synapses at somas and along primary neurite for 3 neurons</span></div><div class='output co'>#&gt; <span class='error'>Error in nat::nlapply(x, hemibrain_remove_bad_synapses.neuron, meshes = meshes,     soma = soma, min.nodes.from.soma = min.nodes.from.soma, min.nodes.from.pnt = min.nodes.from.pnt,     OmitFailures = OmitFailures, ...): formal argument "OmitFailures" matched by multiple actual arguments</span></div><div class='input'>
<span class='co'># Split neuron</span>
<span class='co'>## These are the recommended parameters for hemibrain neurons</span>
<span class='no'>neurons.flow</span> <span class='kw'>=</span> <span class='fu'>flow_centrality</span>(<span class='no'>neurons.checked</span>, <span class='kw'>polypre</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"centrifugal"</span>,
<span class='kw'>split</span> <span class='kw'>=</span> <span class='st'>"distance"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in flow_centrality(neurons.checked, polypre = TRUE, mode = "centrifugal",     split = "distance"): object 'neurons.checked' not found</span></div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Plot the split to check it</span>
<span class='kw pkg'>nat</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nat/man/nopen3d.html'>nopen3d</a></span>()
<span class='fu'><a href='plot3d_split.html'>nlscan_split</a></span>(<span class='no'>neurons.flow</span>, <span class='kw'>WithConnectors</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

}<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


