<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Match up neurons between the hemibrain and FAFB — hemibrain_matching • hemibrainr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Match up neurons between the hemibrain and FAFB — hemibrain_matching" />
<meta property="og:description" content="Match up neurons between the hemibrain, FAFB and light level data and save the
  result using a
  Google
  Sheet on the hemibrain Google Team Drive operated by the flyconnectome
  group at the University of Cambridge. This function
  only considers lateral horn neurons. You must have access to the Team Drive
  in order to use this function. This function makes use of the Google
  Filestream application, which should be installed on your machine. Further,
  note that neurons are read from the FAFB CATMAID project, and you must have
  login details for this project recorded in your .Renviron for this
  function to work." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/flyconnectome/hemibrainr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Match up neurons between the hemibrain and FAFB</h1>
    <small class="dont-index">Source: <a href='https://github.com/flyconnectome/hemibrainr/blob/master/R/hemibrain_matching.R'><code>R/hemibrain_matching.R</code></a></small>
    <div class="hidden name"><code>hemibrain_matching.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Match up neurons between the hemibrain, FAFB and light level data and save the
  result using a
  <a href='https://docs.google.com/spreadsheets/d/1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw/edit#gid=0'>Google
  Sheet</a> on the hemibrain Google Team Drive operated by the flyconnectome
  group at the University of Cambridge. This function
  only considers lateral horn neurons. You must have access to the Team Drive
  in order to use this function. This function makes use of the Google
  Filestream application, which should be installed on your machine. Further,
  note that neurons are read from the FAFB CATMAID project, and you must have
  login details for this project recorded in your .Renviron for this
  function to work.</p>
    </div>

    <pre class="usage"><span class='fu'>hemibrain_matching</span>(
  <span class='kw'>ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>hemibrain.nblast</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>selected_file</span> <span class='kw'>=</span> <span class='st'>"1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw"</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>db</span> <span class='kw'>=</span> <span class='fu'><a href='hemibrain_read_neurons.html'>hemibrain_neurons</a></span>(),
  <span class='kw'>match.type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"FAFB"</span>, <span class='st'>"LM"</span>),
  <span class='kw'>query</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'>lm_matching</span>(
  <span class='kw'>ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>hemibrain.nblast</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>selected_file</span> <span class='kw'>=</span> <span class='st'>"1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw"</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>db</span> <span class='kw'>=</span> <span class='fu'><a href='hemibrain_read_neurons.html'>hemibrain_neurons</a></span>(),
  <span class='kw'>query</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'>fafb_matching</span>(
  <span class='kw'>ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>hemibrain.nblast</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>selected_file</span> <span class='kw'>=</span> <span class='st'>"1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw"</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>db</span> <span class='kw'>=</span> <span class='fu'><a href='hemibrain_read_neurons.html'>hemibrain_neurons</a></span>(),
  <span class='kw'>query</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ids</th>
      <td><p>body IDs for hemibrain neurons present in the
<a href='https://docs.google.com/spreadsheets/d/1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw/edit#gid=0'>Google
 Sheet</a>, for which the user will attempt to make a match if one has not
been made already. Else, LM neuron IDs in the tab 'lm' when using <code>lm_matching</code>.</p></td>
    </tr>
    <tr>
      <th>hemibrain.nblast</th>
      <td><p>a FAFB (rows) - hemibrain (columns) normalised
NBLAST matrix. By default this is read from the flyconnectome Team Drive.</p></td>
    </tr>
    <tr>
      <th>selected_file</th>
      <td><p>the Google Sheet database to read and write from. For
now, defaults to a
<a href='https://docs.google.com/spreadsheets/d/1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw/edit#gid=0'>Google
 Sheet for lateral horn neurons</a>. No other databases have been prepared.</p></td>
    </tr>
    <tr>
      <th>batch_size</th>
      <td><p>the number of FAFB top matches to read from CATMAID in one
go.</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>Either a neuronlist or the name of a character vector naming a
neuronlist. Defaults to the value of <code><a href='hemibrain_read_neurons.html'>hemibrain_neurons</a>()</code>.</p></td>
    </tr>
    <tr>
      <th>match.type</th>
      <td><p>whether to match up FAFB skeletons (<code>"EM"</code>) or light level
skeletons  (<code>"LM"</code>) from Dolan et al. and Frechter et al. 2019 (eLife), stored in the package <code>lhns</code> as
<code>most.lhns</code>.</p></td>
    </tr>
    <tr>
      <th>query</th>
      <td><p>a neuronlist of light level neurons to match against. Should correspond to the given NBLAST matrix.
Defaults to reading a transformed <code>most.lhns</code> from the Hemibrain Google Team Drive.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>logical, whether or not to overwrite matches already made.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Currently, the
  <a href='https://docs.google.com/spreadsheets/d/1OSlDtnR3B1LiB5cwI5x5Ql6LkZd8JOS5bBr-HTi0pOw/edit#gid=0'>Google
   Sheet</a> is set up with  limited number of users, each of whom have been
  assigned a number of neurons to match up. In order to add yourself as a
  user, simply open this Google Sheet in your browser and add your initials
  to neurons of your choosing on the rightmost column 'Users'. Once a match
  is recorded, the user selects a quality for that match. There can be no
  match (n), a poor match (p) an okay match (o) or an exact match (e). As a
  rule of thumb, a poor match could be a neuron from a very similar same cell
  type or a highly untraced neuron that may be the correct cell type. An okay
  match should be a neuron that looks to be from the same morphological cell
  type but there may be some discrepancies in its arbour. An exact match is a
  neuron that corresponds well between FAFB and the hemibrain data.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='hemibrain_adjust_saved_split.html'>hemibrain_adjust_saved_split</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {

<span class='co'># install package to bridge neurons between FAFB14 and hemibrain space</span>
<span class='kw'>if</span> (!<span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span>(<span class='st'>"remotes"</span>)) <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span>(<span class='st'>"remotes"</span>)
<span class='kw pkg'>remotes</span><span class='kw ns'>::</span><span class='fu'><a href='https://remotes.r-lib.org/reference/install_github.html'>install_github</a></span>(<span class='st'>'natverse/nat.jrcbrains'</span>)
<span class='kw pkg'>nat.jrcbrains</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nat.jrcbrains/man/download_saalfeldlab_registrations.html'>download_saalfeldlab_registrations</a></span>()

<span class='co'># Load precomputed NBLAST from the flyconnectome Team Drive</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='st'>"/Volumes/GoogleDrive/Shared drives/flyconnectome/"</span>,
  <span class='st'>"fafbpipeline/fib.fafb.crossnblast.twigs5.mean.compress.rda"</span>))
<span class='co'># Sometimes the filenames are changed by drive</span>
<span class='co'># load(file.path("/Volumes/GoogleDrive/Shared drives/flyconnectome",</span>
<span class='co'># "fafbpipeline/fib.fafb.crossnblast.twigs5.mean.compress (1).rda"))</span>

<span class='co'># Match!</span>
<span class='fu'>hemibrain_matching</span>(<span class='kw'>hemibrain.nblast</span> <span class='kw'>=</span> <span class='no'>fib.fafb.crossnblast.twigs5.mean.compress</span>)
}<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


